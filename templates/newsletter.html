
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio - Dark Admin</title>

    <link rel="stylesheet" type="text/css" href="static/bootstrap.min.css" /> 
    <link rel="stylesheet" type="text/css" href="bootstrap/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="font-awesome/css/font-awesome.min.css" />
   <link rel="stylesheet" type="text/css" href="static/css/local.css" />  

    <script type="text/javascript" src="js/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="bootstrap/js/bootstrap.min.js"></script>

    <style>
        img {
            filter: gray; /* IE6-9 */
            -webkit-filter: grayscale(1); /* Google Chrome, Safari 6+ & Opera 15+ */
            -webkit-box-shadow: 0px 2px 6px 2px rgba(0,0,0,0.75);
            -moz-box-shadow: 0px 2px 6px 2px rgba(0,0,0,0.75);
            box-shadow: 0px 2px 6px 2px rgba(0,0,0,0.75);
            margin-bottom: 20px;
        }
        img:hover {
            filter: none; /* IE6-9 */
            -webkit-filter: grayscale(0); /* Google Chrome, Safari 6+ & Opera 15+ */
        }
    </style>
</head>
<body>
  

    <div id="wrapper">

        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="index.html">{{ curruser }}</a>
            </div>
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav side-nav">
                    <li><a href="index.html"><i class="fa fa-bullseye"></i> My Profile</a></li>
                    <li><a href="/portfolio"><i class="fa fa-bullseye"></i> Matches</a></li>
                    <li><a href="/goals"><i class="fa fa-bullseye"></i> Goals</a></li>
                    <li><a href="/email"><i class="fa fa-bullseye"></i> Goals</a></li>
                    
                             
                </ul>
             
                </ul>
            </div>
        </nav>

        <hr />

        <div class="container">
            <div class="row">
                <div class="text-center">
                    <h1>Ajax</h1>
                </div>
                <form method="post" action="/su">
            <input type = "text" name = "addr" placeholder="Email Address"> 
            <input type = "submit">
               </form>
                 <font color="white"> <p id="messages"> </p> </font>
            <br>
           
            <div id="p1"> </div>
                    
                </div>
            </div>
        </div>
    </div>

    <div>
        <br>
        <br>
        <br>
        <br>

  
    </div>


<script>
//document.getElementById("p1").innerHTML = "New text!";
</script>

    <script>
   // retrieveMessage();
function retrieveMessage() {
   
       var messageTag = document.getElementById('p1'); 
       // document.getElementById("p1").innerHTML = "New text!";
    
    alert("retrive Message");
    var xmlHttp = createXmlHttp();
    xmlHttp.onreadystatechange=function() {
        if(xmlHttp.readyState == 4) {
            showMessages(xmlHttp.responseXML);
        }
    }
    xmlHttp.open("GET",'/messages',true);
    xmlHttp.send();
}
function sendMessage() {
     //document.getElementById("p1").innerHTML = "New text!";
    var inputField = document.getElementById('message_text');
    var text = inputField.value;
    if(inputField) {

      
      alert(text);

        var xmlHttp = createXmlHttp();
        xmlHttp.onreadyexchange = function() {
            if(xmlHttp.readyState == 4) {
                if(xmlHttp.responseText != 'OK') {
                alert('ERROR: ' + xmlHttp.responseText)
            }
           alert("ready state == 4");
        }
    } 

      var parseString = 'text=' + escape(text);
        xmlHttp.open("POST",'/sendmsg',true);
        xmlHttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
        xmlHttp.send(parseString); 
        document.getElementById('messages').innerHTML = document.getElementById('messages').innerHTML + '<li class="list-group-item">' + text + '</li>';

    }
        /*
        xmlhttp.onreadyexchange = function() {
            if(xmlHttp.readyState == 4) {
                if(xmlHttp.responseText != 'OK') {
                    alert("Error:" + xmlHttp.responseText)
                }
            }
        }
        var parseString = 'text=' + escape(text);
        xmlHttp.open("POST",'/sendmsg',true):
        xmlHttp.setRequestHeader("Content-type","application/x-wwww-form-urlencoded");
        xmlHttp.send(parseString);  
    }   */



}

function createXmlHttp() {

var xmlhttp;

if (window.XMLHttpRequest) {

    xmlhttp = new XMLHttpRequest();

} 
else {

    xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");

}

if (!(xmlhttp)) {

    alert("Your browser does not support AJAX!");

}

return xmlhttp;

}  

function showMessages(xml) {
  // document.getElementById("p1").innerHTML = "New text!";

    alert("show message");
   var text = '';
   var messages = xml.getElementByTagName("message");
   //alert(messages.length);
   for(var i = 0; i < messages.length; i++) {
        text += '<div class="subject">';
        text += messages[i].attributes['time'].value;
        text += ' '; 
        text += messages[i].attributes['user'].value;    
        text += 'said:</div>';
        text += '<div class="messagetext>"';
        text += messages[i].textContent;
        text += '</div>';
    }   
    var messageTag = document.getElementById('messages'); 
   document.getElementById("p1").innerHTML = "New text!";
    if(messageTag) {
        messages.innerHTML = "erere";
    }

    setTimeout('retrieveMessages();','2000');
}

    
</script>
<font color="white"><p>yoyoyoyoyo</p></font>
</body>
</html>
